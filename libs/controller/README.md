# Controller Library

###cloudsdk.py : This Library Consists of the following-
    1. class ConfigureController : Base Configuration Class
    2. class Controller(ConfigureController) : Main Cloudsdk Class
    3. class ProfileUtility : Used to CRUD over CloudSDK Profiles Utility
    4. class JFrogUtility : Used for Artifactory Utils, Get latest Build, Upload Firmware etc.

###Note: cloudsdk.py has libraries that uses Swagger Autogenerated Code. 
### Setup The Environment For using the cloudsdk library

Using Swagger Autogenerated CloudSDK Library pypi package (implemented with [swagger codegen](https://github.com/swagger-api/swagger-codegen)).
Using [pytest] as the test execution framework.
Using [pylint](http://pylint.pycqa.org) for code quality monitoring.
Using [allure](https://docs.qameta.io/allure/#_about) with Github Pages to report test outcome.

### Follow the setps below to setup the environment for your development Environment

```shell
mkdir ~/.pip
echo "[global]" > ~/.pip/pip.conf
echo "index-url = https://pypi.org/simple" >> ~/.pip/pip.conf
echo "extra-index-url = https://tip-read:tip-read@tip.jfrog.io/artifactory/api/pypi/tip-wlan-python-pypi-local/simple" >> ~/.pip/pip.conf
```

after that do the following in this folder
```shell
pip3 install -r requirements.txt
```

Now your cloud sdk code is downloaded with all of the dependencies and you can start working on the solution

### Docker

Alternatively you can use provided dockerfiles to develop\lint your code:

```shell
docker build -t wlan-cloud-test -f Dockerfile .
docker build -t wlan-cloud-lint -f Dockerfile-lint .
```

and then you can do something like this to lint your code:

```shell
docker run -it --rm -v %path_to_this_dir%/old_pytest wlan-tip-lint -d protected-access *py # for now
docker run -it --rm -v %path_to_this_dir%/old_pytest wlan-tip-lint *py # for future
```

to have a better output (sorted by line numbers) you can do something like this:

```shell
docker run -it --rm --entrypoint sh -v %path_to_this_dir%/old_pytest wlan-tip-lint -- -c 'pylint *py | sort -t ":" -k 2,2n'
```

and you can use something like this to develop your code:

```shell
docker run -it -v %path_to_this_dir%/old_pytest wlan-tip-test
```

### General guidelines

This testing code adheres to generic [pep8](https://www.python.org/dev/peps/pep-0008/#introduction) style guidelines, most notably:

1. [Documentation strings](https://www.python.org/dev/peps/pep-0008/#documentation-strings)
2. [Naming conventions](https://www.python.org/dev/peps/pep-0008/#prescriptive-naming-conventions)
3. [Sphynx docstring format](https://sphinx-rtd-tutorial.readthedocs.io/en/latest/docstrings.html)

We are using the `pylint` package to do the linting. Documentation for it can be found [here](http://pylint.pycqa.org/en/latest/).
In general, the customizations are possible via the `.pylintrc` file:

1. Line length below 120 characters is fine (search for max-line-length)
2. No new line at the end of file is fine (search for missing-final-newline)
3. Multiple new lines at the end of file are fine (search for trailing-newlines)
4. Indent using 4 spaces (search for indent-string)
5. todo

In future we should enforce a policy, where we cannot merge a code where the pylint scoe goes below 7:

```shell
pylint --fail-under=7 *py
```

the command above would produce a non-zero exit code if the score drops below 7.

### Reporting

Currently the plan is to use pytest integrated with [allure](https://docs.qameta.io/allure/#_pytest) to create visual reports for the test outcomes

### Miscelanneous

1. Do not use old style string formatting: `"Hello %s" % var`; use `f"Hello {var}` instead
2. use `"""` in Docstrings
3. todo

### Useful links

https://docs.pytest.org/en/latest/example/markers.html  
https://docs.pytest.org/en/latest/usage.html  
http://pythontesting.net/framework/pytest/pytest-introduction/